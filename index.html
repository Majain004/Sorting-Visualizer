<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sorting Algorithm Visualizer</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: #f0f0f0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; margin-bottom: 20px; }
        .controls { display: flex; flex-wrap: wrap; gap: 15px; align-items: center; padding: 15px; background: #f8f9fa; border-radius: 8px; margin-bottom: 20px; }
        .control-group { display: flex; align-items: center; gap: 8px; }
        label { font-weight: 600; color: #555; }
        select, input[type="number"] { padding: 8px 12px; border: 2px solid #ddd; border-radius: 5px; font-size: 14px; }
        input[type="range"] { width: 150px; }
        button { padding: 10px 20px; border: none; border-radius: 5px; font-weight: 600; cursor: pointer; transition: all 0.3s; font-size: 14px; }
        button:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-generate { background: #3b82f6; color: white; }
        .btn-start { background: #10b981; color: white; }
        .btn-pause { background: #f59e0b; color: white; }
        .btn-reset { background: #ef4444; color: white; }
        .custom-input { width: 100%; padding: 15px; background: #f8f9fa; border-radius: 8px; margin-bottom: 20px; }
        .custom-input input[type="text"] { width: calc(100% - 200px); padding: 8px 12px; border: 2px solid #ddd; border-radius: 5px; margin-right: 10px; }
        .status-message { display: inline-block; margin-left: 10px; font-size: 12px; font-weight: 600; }
        .status-success { color: #10b981; }
        .status-error { color: #ef4444; }
        .canvas-container { background: white; border: 2px solid #e5e7eb; border-radius: 8px; padding: 15px; margin-bottom: 20px; height: 400px; position: relative; }
        #canvas { width: 100%; height: 100%; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .stat-box { text-align: center; padding: 15px; background: white; border-radius: 8px; border-left: 4px solid; }
        .stat-box.comparisons { border-color: #3b82f6; }
        .stat-box.swaps { border-color: #10b981; }
        .stat-box.writes { border-color: #f59e0b; }
        .stat-box.steps { border-color: #8b5cf6; }
        .stat-box.time { border-color: #ef4444; }
        .stat-label { font-size: 12px; color: #64748b; font-weight: 600; margin-bottom: 5px; }
        .stat-value { font-size: 24px; font-weight: 700; color: #1e293b; }
        .info-label { text-align: center; padding: 10px; color: #64748b; font-size: 14px; min-height: 30px; }
        @media (max-width: 768px) {
            .controls { flex-direction: column; align-items: stretch; }
            .control-group { width: 100%; }
            button { width: 100%; }
            .custom-input input[type="text"] { width: 100%; margin-bottom: 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Sorting Algorithm Visualizer</h1>
        <div class="controls">
            <div class="control-group">
                <label>Algorithm:</label>
                <select id="algorithm">
                    <option value="bubble">Bubble Sort</option>
                    <option value="selection">Selection Sort</option>
                    <option value="insertion">Insertion Sort</option>
                    <option value="merge">Merge Sort</option>
                    <option value="quick">Quick Sort</option>
                </select>
            </div>
            <div class="control-group">
                <label>Array Size:</label>
                <input type="number" id="arraySize" min="10" max="99" value="50">
            </div>
            <div class="control-group">
                <label>Speed (ms):</label>
                <input type="range" id="speed" min="1" max="200" value="30">
                <span id="speedValue">30</span>
            </div>
            <button class="btn-generate" onclick="generateArray()">üîÑ Generate</button>
            <button class="btn-start" id="startBtn" onclick="startSort()">‚ñ∂Ô∏è Start</button>
            <button class="btn-pause" id="pauseBtn" onclick="pauseSort()">‚è∏Ô∏è Pause</button>
            <button class="btn-reset" onclick="resetArray()">üîÑ Reset</button>
        </div>
        <div class="custom-input">
            <label style="display: block; margin-bottom: 8px;">Custom Array (comma or space separated, 1-400, max 1000 numbers):</label>
            <input type="text" id="customArray" placeholder="e.g., 64, 34, 25, 12, 22, 11, 90">
            <button class="btn-generate" onclick="loadCustomArray()">Load Custom Array</button>
            <span id="customStatus" class="status-message"></span>
        </div>
        <div class="canvas-container">
            <canvas id="canvas"></canvas>
        </div>
        <div class="info-label" id="infoLabel"></div>
        <div class="stats">
            <div class="stat-box comparisons"><div class="stat-label">Comparisons</div><div class="stat-value" id="comparisons">0</div></div>
            <div class="stat-box swaps"><div class="stat-label">Swaps</div><div class="stat-value" id="swaps">0</div></div>
            <div class="stat-box writes"><div class="stat-label">Writes</div><div class="stat-value" id="writes">0</div></div>
            <div class="stat-box steps"><div class="stat-label">Total Steps</div><div class="stat-value" id="steps">0</div></div>
            <div class="stat-box time"><div class="stat-label">Time</div><div class="stat-value" id="time">0.00s</div></div>
        </div>
    </div>
    <script>
        let array = [], originalArray = [], canvas, ctx, running = false, paused = false;
        let comparisons = 0, swaps = 0, writes = 0, steps = 0, startTime = 0;

        window.onload = function() {
            canvas = document.getElementById('canvas');
            ctx = canvas.getContext('2d');
            resizeCanvas();
            generateArray();
            document.getElementById('speed').oninput = function() {
                document.getElementById('speedValue').textContent = this.value;
            };
            window.onresize = resizeCanvas;
        };

        function resizeCanvas() {
            const container = canvas.parentElement;
            canvas.width = container.clientWidth - 30;
            canvas.height = container.clientHeight - 30;
            drawArray();
        }

        function generateArray() {
            const size = parseInt(document.getElementById('arraySize').value);
            array = [];
            for (let i = 0; i < size; i++) array.push(Math.floor(Math.random() * 376) + 5);
            originalArray = [...array];
            resetStats();
            drawArray();
            document.getElementById('customStatus').textContent = '';
        }

        function loadCustomArray() {
            const input = document.getElementById('customArray').value.trim();
            const statusEl = document.getElementById('customStatus');
            if (!input) { statusEl.textContent = '‚ö†Ô∏è Please enter numbers'; statusEl.className = 'status-message status-error'; return; }
            try {
                const numbers = input.replace(/,/g, ' ').split(/\s+/).map(n => parseInt(n));
                if (numbers.some(isNaN)) { statusEl.textContent = '‚ö†Ô∏è Invalid input'; statusEl.className = 'status-message status-error'; return; }
                if (numbers.some(n => n < 1 || n > 400)) { statusEl.textContent = '‚ö†Ô∏è Numbers must be 1-400'; statusEl.className = 'status-message status-error'; return; }
                if (numbers.length < 2) { statusEl.textContent = '‚ö†Ô∏è At least 2 numbers'; statusEl.className = 'status-message status-error'; return; }
                if (numbers.length > 1000) { statusEl.textContent = '‚ö†Ô∏è Max 1000 numbers'; statusEl.className = 'status-message status-error'; return; }
                array = numbers;
                originalArray = [...array];
                resetStats();
                drawArray();
                statusEl.textContent = `‚úì Loaded ${numbers.length} numbers`;
                statusEl.className = 'status-message status-success';
            } catch (e) { statusEl.textContent = '‚ö†Ô∏è Invalid input'; statusEl.className = 'status-message status-error'; }
        }

        function resetArray() { running = false; paused = false; array = [...originalArray]; resetStats(); drawArray(); document.getElementById('infoLabel').textContent = ''; }
        function resetStats() { comparisons = swaps = writes = steps = 0; startTime = Date.now(); updateStats(); }
        function updateStats() {
            document.getElementById('comparisons').textContent = comparisons;
            document.getElementById('swaps').textContent = swaps;
            document.getElementById('writes').textContent = writes;
            document.getElementById('steps').textContent = steps;
            document.getElementById('time').textContent = ((Date.now() - startTime) / 1000).toFixed(2) + 's';
        }

        function drawArray(highlights = [], color = '#3b82f6') {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const barWidth = canvas.width / array.length;
            const maxVal = Math.max(...array);
            for (let i = 0; i < array.length; i++) {
                const barHeight = (array[i] / maxVal) * (canvas.height - 30);
                const x = i * barWidth, y = canvas.height - barHeight;
                ctx.fillStyle = highlights.includes(i) ? color : '#4A90E2';
                ctx.fillRect(x, y, barWidth - 2, barHeight);
                if (array.length <= 60 && barWidth > 12) {
                    ctx.fillStyle = barHeight > 25 ? '#000' : '#fff';
                    ctx.font = `${Math.max(8, Math.min(barWidth / 2.5, 11))}px Arial`;
                    ctx.textAlign = 'center';
                    ctx.fillText(array[i], x + barWidth / 2, barHeight > 25 ? y - 5 : canvas.height - 5);
                }
            }
        }

        async function sleep(ms) { return new Promise(resolve => setTimeout(resolve, ms)); }

        async function startSort() {
            if (running) return;
            running = true; paused = false; resetStats();
            const algo = document.getElementById('algorithm').value;
            document.getElementById('startBtn').disabled = true;
            try {
                switch(algo) {
                    case 'bubble': await bubbleSort(); break;
                    case 'selection': await selectionSort(); break;
                    case 'insertion': await insertionSort(); break;
                    case 'merge': await mergeSort(0, array.length - 1); break;
                    case 'quick': await quickSort(0, array.length - 1); break;
                }
                if (running) { document.getElementById('infoLabel').textContent = 'Sorting Complete!'; drawArray(array.map((_, i) => i), '#10b981'); }
            } catch (e) { console.error(e); }
            running = false;
            document.getElementById('startBtn').disabled = false;
        }

        function pauseSort() { running = false; paused = true; }

        async function bubbleSort() {
            const n = array.length;
            for (let i = 0; i < n && running; i++) {
                let swapped = false;
                for (let j = 0; j < n - i - 1 && running; j++) {
                    steps++; comparisons++;
                    drawArray([j, j + 1], '#ef4444'); updateStats();
                    await sleep(document.getElementById('speed').value);
                    if (array[j] > array[j + 1]) {
                        [array[j], array[j + 1]] = [array[j + 1], array[j]]; swaps++;
                        drawArray([j, j + 1], '#10b981'); updateStats();
                        await sleep(document.getElementById('speed').value);
                        swapped = true;
                    }
                }
                if (!swapped) break;
            }
        }

        async function selectionSort() {
            const n = array.length;
            for (let i = 0; i < n && running; i++) {
                let minIdx = i;
                for (let j = i + 1; j < n && running; j++) {
                    steps++; comparisons++;
                    drawArray([minIdx, j], '#ef4444'); updateStats();
                    await sleep(document.getElementById('speed').value);
                    if (array[j] < array[minIdx]) minIdx = j;
                }
                if (minIdx !== i) {
                    [array[i], array[minIdx]] = [array[minIdx], array[i]]; swaps++;
                    drawArray([i, minIdx], '#10b981'); updateStats();
                    await sleep(document.getElementById('speed').value);
                }
            }
        }

        async function insertionSort() {
            for (let i = 1; i < array.length && running; i++) {
                let key = array[i], j = i - 1;
                while (j >= 0 && running) {
                    steps++; comparisons++;
                    drawArray([j, j + 1], '#ef4444'); updateStats();
                    await sleep(document.getElementById('speed').value);
                    if (array[j] > key) { array[j + 1] = array[j]; writes++; j--; } else break;
                }
                array[j + 1] = key; writes++;
                drawArray([j + 1], '#10b981'); updateStats();
                await sleep(document.getElementById('speed').value);
            }
        }

        async function mergeSort(l, r) {
            if (!running || l >= r) return;
            const m = Math.floor((l + r) / 2);
            await mergeSort(l, m); await mergeSort(m + 1, r); await merge(l, m, r);
        }

        async function merge(l, m, r) {
            const left = array.slice(l, m + 1), right = array.slice(m + 1, r + 1);
            let i = 0, j = 0, k = l;
            while (i < left.length && j < right.length && running) {
                steps++; comparisons++;
                drawArray([k], '#ef4444'); updateStats();
                await sleep(document.getElementById('speed').value);
                array[k] = (left[i] <= right[j]) ? left[i++] : right[j++];
                writes++;
                drawArray([k], '#10b981'); updateStats(); k++;
            }
            while (i < left.length && running) { array[k++] = left[i++]; writes++; drawArray([k-1], '#10b981'); updateStats(); }
            while (j < right.length && running) { array[k++] = right[j++]; writes++; drawArray([k-1], '#10b981'); updateStats(); }
        }

        async function quickSort(l, r) {
            if (!running || l >= r) return;
            const pi = await partition(l, r);
            await quickSort(l, pi - 1); await quickSort(pi + 1, r);
        }

        async function partition(l, r) {
            const pivot = array[r];
            let i = l - 1;
            for (let j = l; j < r && running; j++) {
                steps++; comparisons++;
                drawArray([j, r], '#ef4444'); updateStats();
                await sleep(document.getElementById('speed').value);
                if (array[j] < pivot) {
                    i++;
                    [array[i], array[j]] = [array[j], array[i]]; swaps++;
                    drawArray([i, j], '#10b981'); updateStats();
                    await sleep(document.getElementById('speed').value);
                }
            }
            [array[i + 1], array[r]] = [array[r], array[i + 1]]; swaps++;
            drawArray([i + 1, r], '#10b981'); updateStats();
            await sleep(document.getElementById('speed').value);
            return i + 1;
        }
    </script>
</body>
</html>